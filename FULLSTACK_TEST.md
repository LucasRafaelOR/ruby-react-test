# Problem

We want users to have dynamic forms where a JSON describes how this form must be and what kind of input it must accept.
When submitted this form must generate a YAML file saved in the database.

Other way to describe the problem is: We want users to fill structured YAMLs in the UI without the need to write the YAML files
themselves. These YAML files must obey a specified format defined by an administrator user and be validated against it.

For example, if the administrator would like to specify that he/she wants an HTML form to fill this YAML (fields with <> are
meant to be entered by the user)

```
static_key: <value>
```

He/she would specify this with the JSON:

```
[{
  "key": {
    "type": "text",
    "mutable": false,
    "default": "static_key"
  },
  "value": {
    "type": "text",
    "mutable": true
  }
}]
```

The JSON above is a description of the form to be generated, it means that the form has just one entry, the key can't be
changed by the user and has the default value of "static_key", while the value can be edited by the user and is of type
`text`. The HTML form generated by this JSON specification could be:

```
<div>
  static_key: <input type="text">
</div>
```

Another example, to specify a YAML like:

```
---
static_key1: <value1>
static_key2: <value2>
```

The JSON specification would be:

```
[{
  "key": {
    "type": "text",
    "mutable": false,
    "default": "static_key1"
  },
  "value": {
    "type": "text",
    "mutable": true
  }
},
{
  "key": {
    "type": "text",
    "mutable": false,
    "default": "static_key2"
  },
  "value": {
    "type": "text",
    "mutable": true
  }
}]
```

The examples above always have static keys, but suppose we want to represent a YAML like the `database.yml` file used by
Rails applications

```
---
<environment_1>:
  database: <database>
  username: <username>
<environment_n>:
  database: <database>
  username: <username>
```

The JSON for that would be:

```
[{
  "key": {
    "type": "text",
    "mutable": true,
    "multiple": true
  },
  "value" {
    "type": "child",
  }
  "children": [{
    "key": {
      "type": "text",
      "mutable": false,
      "default": "database"
    },
    "value": {
      "type": "text",
      "mutable": true
    }
  },
  {
    "key": {
      "type": "text",
      "mutable": false,
      "default": "username"
    },
    "value": {
      "type": "text",
      "mutable": true
    }
  }]
}]
```

Few things to note:
- type == "child" is not allowed on keys.
- If type == "child", "mutable" and "default" fields have no mean and can be ignored.
- To make things simpler, if type == "child", consider "multiple" always false for the value.
- Any entry with "mutable" == false and "multiple" == true is an error.
- children can have children.
- "multiple" field is default to false.
- Entries with "mutable" == false *must* have a non empty "default" field.
- Only one entry with mutable key must exists on a YAML "level", e.g. this YAML spec is impossible to write and considered
invalid:

```
---
<mutable_key1>: <value>
<mutable_key2>: <value2>
```

This creates ambiguity, so it's considered a invalid use case.

So the JSON format used to describe the forms can be represented as the following pseudo JSONs:


```
EntryDefinition = {
  "type": "text" | "integer",
  "mutable": boolean [default to false],
  "default": string [default to empty],
  "multiple": boolean [default to false],
}

KeyValuePairDefinition = {
  "key": EntryDefinition,
  "value": EntryDefinition,
  children: YAMLSpec
}

YAMLSpec = [KeyValuePairDefinition, ...]
```

# The test

So... what to do in the test?

Implement a simple web-app that:

- Have no authentication at all.
- Have the backend implemented in Ruby or Crystal, using any framework of choice.
- Have the frontend implemented in React.
- The Front page that:
  - List the available JSON form specifications.
  - Have a button to create a new JSON form specification.
    - JSON form specification must be validated on backend.
  - Clicking on a JSON form specification you are redirected to a page that:
    - Has a button to create a new value for this JSON form specification.
      - Here the HTML form generated using the specification must be show.
      - Data from this HTML form must be validated on backend.
      - When user hit save, the form data must be saved in the database.
    - Have a list of values saved from forms using this JSON form specification.
    - For each value you can preview the generated YAML or edit the value in the HTML form.

Important! Do what you can, if you don't have time to do everything just document what's missing in your implementation.

# Bonus
- Implement a React editor for YAML specifications instead of a plain text-area.
